version: '1.0'
name: update-metadata
displayName: update-metadata
triggers:
  trigger: auto
  push:
    branches:
      prefix:
        - ''
stages:
  - name: stage-5f7636e6
    displayName: 执行脚本
    strategy: naturally
    trigger: auto
    executor: []
    steps:
      - step: build@nodejs
        name: build_nodejs
        displayName: Nodejs 构建
        nodeVersion: 14.16.0
        commands:
          - '# 执行脚本生成 metadata.json'
          - node ./update-metadata.js
          - git add metadata.json
          - git commit -m "auto: 自动更新metadata.json" || echo "无变更"
          - git push "https://${TOKEN}@gitee.com/Geoffwo/rule-process-plugin.git" HEAD:refs/heads/master
        caches: []
        notify: []
        strategy:
          retry: '0'
